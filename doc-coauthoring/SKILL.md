---
name: doc-coauthoring
description: 引导用户完成结构化文档协作编写工作流程。当用户想要编写文档、提案、技术规范、决策文档或类似结构化内容时使用。此工作流程帮助用户高效传递上下文、通过迭代完善内容，并验证文档对读者有效。当用户提到编写文档、创建提案、起草规范或类似文档任务时触发。
---

# 文档协作编写工作流程

此技能提供了一个结构化工作流程，用于引导用户完成协作文档创建。作为主动引导者，引导用户完成三个阶段：上下文收集、完善和结构，以及读者测试。

## 何时提供此工作流程

**触发条件**：
- 用户提到编写文档："write a doc"、"draft a proposal"、"create a spec"、"write up"
- 用户提到特定文档类型："PRD"、"design doc"、"decision doc"、"RFC"
- 用户似乎正在开始大量写作任务

**初始提供**：
向用户提供协作编写文档的结构化工作流程。解释三个阶段：

1. **上下文收集**：用户提供所有相关上下文，同时 Claude 提出澄清问题
2. **完善和结构**：通过头脑风暴和编辑迭代构建每个部分
3. **读者测试**：使用新的 Claude（无上下文）测试文档，以便在他人在阅读之前发现盲点

解释这种方法有助于确保文档在他人阅读时效果良好（包括当他们将其粘贴到 Claude 时）。询问他们是否想尝试此工作流程或更喜欢自由形式工作。

如果用户拒绝，自由形式工作。如果用户接受，继续到阶段 1。

## 阶段 1：上下文收集

**目标**：缩小用户知道的内容和 Claude 知道的内容之间的差距，以便以后能够提供智能指导。

### 初始问题

首先询问用户关于文档的元上下文：

1. 这是什么类型的文档？（例如，技术规范、决策文档、提案）
2. 主要受众是谁？
3. 当有人阅读此文档时，期望产生什么影响？
4. 是否有要遵循的模板或特定格式？
5. 还有其他需要了解的约束或上下文吗？

告知他们可以用简写回答或以任何最适合他们的方式转储信息。

**如果用户提供模板或提到文档类型**：
- 询问他们是否有要分享的模板文档
- 如果他们提供共享文档的链接，使用适当的集成来获取它
- 如果他们提供文件，读取它

**如果用户提到编辑现有的共享文档**：
- 使用适当的集成读取当前状态
- 检查没有 alt-text 的图像
- 如果存在没有 alt-text 的图像，解释当其他人使用 Claude 理解文档时，Claude 将无法看到它们。询问他们是否想要生成 alt-text。如果是，请求他们将每个图像粘贴到聊天中以生成描述性 alt-text。

### 信息转储

一旦初始问题得到回答，鼓励用户转储他们拥有的所有上下文。请求诸如以下信息：
- 项目/问题的背景
- 相关的团队讨论或共享文档
- 为什么不使用替代解决方案
- 组织上下文（团队动态、过去的事件、政治）
- 时间压力或约束
- 技术架构或依赖项
- 利益相关者的关注

建议他们不要担心组织它 - 只需全部说出来。提供多种提供上下文的方式：
- 信息转储意识流
- 指向要阅读的团队频道或线程
- 链接到共享文档

**如果集成可用**（例如，Slack、Teams、Google Drive、SharePoint 或其他 MCP 服务器），提及这些可用于直接拉取上下文。

**如果未检测到集成且在 Claude.ai 或 Claude 应用中**：建议他们可以在 Claude 设置中启用连接器，以允许直接从消息应用和文档存储中拉取上下文。

告知他们一旦他们完成初始转储，将提出澄清问题。

**在上下文收集期间**：

- 如果用户提到团队频道或共享文档：
  - 如果集成可用：告知他们现在将读取内容，然后使用适当的集成
  - 如果集成不可用：解释缺乏访问权限。建议他们在 Claude 设置中启用连接器，或直接粘贴相关内容。

- 如果用户提到未知的实体/项目：
  - 询问是否应该搜索连接的工具以了解更多信息
  - 等待用户确认后再搜索

- 当用户提供上下文时，跟踪正在学习的内容和仍然不清楚的内容

**提出澄清问题**：

当用户表示他们已经完成初始转储（或在提供大量上下文后），提出澄清问题以确保理解：

基于上下文中的差距生成 5-10 个编号问题。

告知他们可以使用简写回答（例如，"1: yes, 2: see #channel, 3: no because backwards compat"）、链接到更多文档、指向要阅读的频道，或继续信息转储。任何对他们最有效的方式。

**退出条件**：
当问题显示理解时，已收集足够的上下文 - 当可以在不需要解释基础知识的情况下询问边缘情况和权衡时。

**过渡**：
询问在此阶段是否还有更多上下文要提供，或者是否该继续起草文档了。

如果用户想添加更多，让他们添加。准备好后，继续到阶段 2。

## 阶段 2：完善和结构

**目标**：通过头脑风暴、策划和迭代完善逐节构建文档。

**给用户的说明**：
解释文档将逐节构建。对于每个部分：
1. 将询问关于要包含内容的澄清问题
2. 将头脑风暴 5-20 个选项
3. 用户将指示保留/删除/组合什么
4. 将起草该部分
5. 将通过外科编辑进行完善

从具有最多未知数的部分开始（通常是核心决策/提案），然后处理其余部分。

**部分排序**：

如果文档结构清晰：
询问他们想从哪个部分开始。

建议从具有最多未知数的部分开始。对于决策文档，通常是核心提案。对于规范，通常是技术方法。摘要部分最好留到最后。

如果用户不知道他们需要什么部分：
根据文档类型和模板，建议 3-5 个适合文档类型的部分。

询问此结构是否有效，或者他们是否想调整它。

**一旦结构达成一致**：

创建所有部分的初始文档结构，带有占位符文本。

**如果可以使用工件**：
使用 `create_file` 创建工件。这为 Claude 和用户提供了一个脚手架。

告知将创建所有部分的初始结构，带有占位符。

创建包含所有部分标题和简短占位符文本（如 "[待编写]" 或 "[内容在此]"）的工件。

提供脚手架链接并指示是时候填写每个部分了。

**如果无法访问工件**：
在工作目录中创建 markdown 文件。适当命名（例如，`decision-doc.md`、`technical-spec.md`）。

告知将创建所有部分的初始结构，带有占位符。

创建包含所有部分标题和占位符文本的文件。

确认文件名已创建并指示是时候填写每个部分了。

**对于每个部分**：

### 步骤 1：澄清问题

宣布将开始处理 [部分名称] 部分。询问 5-10 个关于应包含内容的澄清问题：

基于上下文和部分目的生成 5-10 个具体问题。

告知他们可以用简写回答或仅指示重要的是要涵盖的内容。

### 步骤 2：头脑风暴

对于 [部分名称] 部分，头脑风暴 [5-20] 个可能包含的内容，取决于部分的复杂性。寻找：
- 可能被遗忘的共享上下文
- 尚未提及的角度或考虑因素

基于部分复杂性生成 5-20 个编号选项。最后，如果他们想要更多选项，提供更多头脑风暴。

### 步骤 3：策划

询问哪些要点应该保留、删除或组合。请求简要理由以帮助了解下一部分的优先级。

提供示例：
- "Keep 1,4,7,9"
- "Remove 3 (duplicates 1)"
- "Remove 6 (audience already knows this)"
- "Combine 11 and 12"

**如果用户提供自由形式反馈**（例如，"looks good" 或 "I like most of it but..."）而不是编号选择，提取他们的偏好并继续。解析他们想要保留/删除/更改的内容并应用它。

### 步骤 4：差距检查

基于他们选择的内容，询问 [部分名称] 部分是否缺少任何重要内容。

### 步骤 5：起草

使用 `str_replace` 将此部分的占位符文本替换为实际起草的内容。

宣布现在将基于他们选择的内容起草 [部分名称] 部分。

**如果使用工件**：
起草后，提供工件链接。

要求他们阅读并指示要更改的内容。注意，具体有助于为下一部分学习。

**如果使用文件（无工件）**：
起草后，确认完成。

告知 [部分名称] 部分已在 [文件名] 中起草。要求他们阅读并指示要更改的内容。注意，具体有助于为下一部分学习。

**给用户的关键说明（在起草第一部分时包含）**：
提供说明：不要直接编辑文档，而是要求他们指示要更改的内容。这有助于学习他们的风格以便将来部分。例如："Remove the X bullet - already covered by Y" 或 "Make the third paragraph more concise"。

### 步骤 6：迭代完善

当用户提供反馈时：
- 使用 `str_replace` 进行编辑（永远不要重新打印整个文档）
- **如果使用工件**：每次编辑后提供工件链接
- **如果使用文件**：仅确认编辑完成
- 如果用户直接编辑文档并要求读取：在心理上注意他们所做的更改，并在将来部分记住它们（这显示了他们的偏好）

**继续迭代**直到用户对部分满意。

### 质量检查

在 3 次连续迭代没有实质性更改后，询问是否可以删除任何内容而不丢失重要信息。

当部分完成时，确认 [部分名称] 已完成。询问是否准备好继续下一部分。

**对所有部分重复。**

### 接近完成

当接近完成（80%+ 的部分完成）时，宣布将重新阅读整个文档并检查：
- 各部分之间的流程和一致性
- 冗余或矛盾
- 任何感觉像"草率"或通用填充的内容
- 每个句子是否都有分量

阅读整个文档并提供反馈。

**当所有部分都已起草和完善时**：
宣布所有部分都已起草。表示将再次审查完整文档。

审查整体连贯性、流程、完整性。

提供任何最终建议。

询问是否准备好继续到读者测试，或者他们是否想完善其他内容。

## 阶段 3：读者测试

**目标**：使用新的 Claude（无上下文泄漏）测试文档以验证它对读者有效。

**给用户的说明**：
解释现在将进行测试以查看文档是否真的对读者有效。这可以捕获盲点 - 对作者有意义但可能使他人困惑的内容。

### 测试方法

**如果可以访问子代理（例如，在 Claude Code 中）**：

直接执行测试，无需用户参与。

### 步骤 1：预测读者问题

宣布将预测读者在尝试发现此文档时可能提出的问题。

生成 5-10 个读者会实际提出的问题。

### 步骤 2：使用子代理测试

宣布将使用新的 Claude 实例（无此对话的上下文）测试这些问题。

对于每个问题，仅使用文档内容和问题调用子代理。

总结 Reader Claude 对每个问题回答正确/错误的内容。

### 步骤 3：运行额外检查

宣布将执行额外检查。

调用子代理检查歧义、错误假设、矛盾。

总结发现的任何问题。

### 步骤 4：报告和修复

如果发现问题：
报告 Reader Claude 在特定问题上遇到困难。

列出具体问题。

表示将修复这些差距。

循环回到有问题的部分的完善。

---

**如果无法访问子代理（例如，claude.ai Web 界面）**：

用户需要手动进行测试。

### 步骤 1：预测读者问题

询问人们在尝试发现此文档时可能提出的问题。他们会向 Claude.ai 输入什么？

生成 5-10 个读者会实际提出的问题。

### 步骤 2：设置测试

提供测试说明：
1. 打开新的 Claude 对话：https://claude.ai
2. 粘贴或分享文档内容（如果使用启用了连接器的共享文档平台，提供链接）
3. 向 Reader Claude 提出生成的问题

对于每个问题，指示 Reader Claude 提供：
- 答案
- 是否有任何内容对读者来说是模糊或不清楚的
- 文档假设读者已经知道的知识/上下文

检查 Reader Claude 是否给出正确答案或误解任何内容。

### 步骤 3：额外检查

还询问 Reader Claude：
- "此文档中哪些内容对读者来说可能是模糊或不清楚的？"
- "此文档假设读者已经拥有什么知识或上下文？"
- "是否有任何内部矛盾或不一致？"

### 步骤 4：基于结果迭代

询问 Reader Claude 回答错误或遇到困难的内容。表示将修复这些差距。

循环回到任何有问题的部分的完善。

---

### 退出条件（两种方法）

当 Reader Claude 一致地正确回答问题并且不出现新的差距或歧义时，文档已准备好。

## 最终审查

当读者测试通过时：
宣布文档已通过 Reader Claude 测试。在完成之前：

1. 建议他们自己进行最终阅读 - 他们拥有此文档并对其质量负责
2. 建议仔细检查任何事实、链接或技术细节
3. 要求他们验证它是否达到了他们想要的影响

询问他们是否想要再次审查，或者工作是否完成。

**如果用户想要最终审查，提供它。否则：**
宣布文档完成。提供一些最终提示：
- 考虑在附录中链接此对话，以便读者可以看到文档是如何开发的
- 使用附录提供深度而不使主文档臃肿
- 当从真实读者那里收到反馈时更新文档

## 有效指导的技巧

**语调**：
- 直接和程序化
- 当它影响用户行为时简要解释理由
- 不要试图"推销"方法 - 只需执行它

**处理偏差**：
- 如果用户想跳过阶段：询问他们是否想跳过此并自由形式编写
- 如果用户似乎沮丧：承认这比预期花费更长时间。建议加快速度的方法
- 始终给用户调整过程的自主权

**上下文管理**：
- 在整个过程中，如果提到某些内容缺少上下文，主动询问
- 不要让差距累积 - 在它们出现时解决它们

**工件管理**：
- 使用 `create_file` 起草完整部分
- 使用 `str_replace` 进行所有编辑
- 每次更改后提供工件链接
- 永远不要将工件用于头脑风暴列表 - 这只是对话

**质量优于速度**：
- 不要匆忙完成阶段
- 每次迭代都应该产生有意义的改进
- 目标是真正对读者有效的文档
